package main

import (
	"fmt"
	"os"

	// "github.com/fatih/color"
)

func main() {
	if len(os.Args) != 3 {
		usage()
	}

	if checkFile(os.Args[1]) {
		(*ConfigData).parseJSON(&configData, os.Args[1])
	}

	if checkFile(os.Args[2]) {
		(*RequestData).parseJSON(&requestData, os.Args[2])
	}

	termChan = make(chan os.Signal, 1)
	intChan = make(chan os.Signal, 1)

	printName()
	// runTimer("tmp", configData.Timeout)

	// printConfig()

	// fmt.Println("------------------------------------------------------------")

	// printRequest()

	// fmt.Println("------------------------------------------------------------")


	os.Setenv("LOGIN_COOKIE", "checkFuzz=true")
	// Login()

	// fmt.Println("------------------------------------------------------------")

	// testLogin()

	// test
	runAFL(initDir(0), 0)
	// fmt.Println(targetPoints)
}

func usage() {
	fmt.Println("Usage : fuzzer <path of config file> <path of request data file>")
	fmt.Println("Example : fuzzer config.json request_data.json")

	os.Exit(-1)
}

func checkFile(fileName string) bool {
    _, err := os.Stat(fileName)

    if os.IsNotExist(err) {
        fmt.Printf("%v File does not exist. Please check your path.\n", fileName)
		panic(err)
	}

	return true
}

func printName() {
	fmt.Println("\033[38;5;118m \033[39m\033[38;5;118m \033[39m\033[38;5;118m \033[39m\033[38;5;118m \033[39m\033[38;5;118m \033[39m\033[38;5;118m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m_\033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;148m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m_\033[39m\033[38;5;184m_\033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;178m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;208m_\033[39m\033[38;5;208m_\033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;209m \033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;163m \033[39m\033[38;5;164m\033[39m")
	fmt.Println("\033[38;5;118m \033[39m\033[38;5;118m \033[39m\033[38;5;118m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m|\033[39m\033[38;5;148m \033[39m\033[38;5;184m|\033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m/\033[39m\033[38;5;184m \033[39m\033[38;5;184m/\033[39m\033[38;5;184m_\033[39m\033[38;5;184m_\033[39m\033[38;5;178m \033[39m\033[38;5;214m \033[39m\033[38;5;214m/\033[39m\033[38;5;214m \033[39m\033[38;5;214m/\033[39m\033[38;5;214m_\033[39m\033[38;5;214m/\033[39m\033[38;5;214m_\033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;208m_\033[39m\033[38;5;208m_\033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m_\033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m_\033[39m\033[38;5;208m_\033[39m\033[38;5;209m_\033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m/\033[39m\033[38;5;203m \033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m/\033[39m\033[38;5;203m_\033[39m\033[38;5;203m \033[39m\033[38;5;198m \033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;199m_\033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m_\033[39m\033[38;5;199m_\033[39m\033[38;5;199m_\033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m_\033[39m\033[38;5;163m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m\033[39m")
	fmt.Println("\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;148m \033[39m\033[38;5;184m \033[39m\033[38;5;184m|\033[39m\033[38;5;184m \033[39m\033[38;5;184m|\033[39m\033[38;5;184m \033[39m\033[38;5;184m/\033[39m\033[38;5;184m|\033[39m\033[38;5;184m \033[39m\033[38;5;184m/\033[39m\033[38;5;184m \033[39m\033[38;5;184m/\033[39m\033[38;5;178m \033[39m\033[38;5;214m_\033[39m\033[38;5;214m \033[39m\033[38;5;214m\\\033[39m\033[38;5;214m/\033[39m\033[38;5;214m \033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m \033[39m\033[38;5;214m\\\033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m_\033[39m\033[38;5;208m_\033[39m\033[38;5;208m \033[39m\033[38;5;208m\\\033[39m\033[38;5;209m/\033[39m\033[38;5;203m \033[39m\033[38;5;203m_\033[39m\033[38;5;203m \033[39m\033[38;5;203m\\\033[39m\033[38;5;203m/\033[39m\033[38;5;203m \033[39m\033[38;5;203m/\033[39m\033[38;5;203m_\033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;198m_\033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;199m_\033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m/\033[39m\033[38;5;199m \033[39m\033[38;5;199m/\033[39m\033[38;5;199m \033[39m\033[38;5;199m_\033[39m\033[38;5;199m \033[39m\033[38;5;163m\\\033[39m\033[38;5;164m/\033[39m\033[38;5;164m \033[39m\033[38;5;164m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m/\033[39m\033[38;5;164m\033[39m")
	fmt.Println("\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;148m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m|\033[39m\033[38;5;184m \033[39m\033[38;5;184m|\033[39m\033[38;5;184m/\033[39m\033[38;5;184m \033[39m\033[38;5;184m|\033[39m\033[38;5;184m/\033[39m\033[38;5;178m \033[39m\033[38;5;214m/\033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m/\033[39m\033[38;5;214m \033[39m\033[38;5;214m/\033[39m\033[38;5;214m_\033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;209m/\033[39m\033[38;5;203m \033[39m\033[38;5;203m/\033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m/\033[39m\033[38;5;203m \033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;198m_\033[39m\033[38;5;198m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m/\033[39m\033[38;5;199m \033[39m\033[38;5;199m/\033[39m\033[38;5;199m_\033[39m\033[38;5;199m/\033[39m\033[38;5;199m \033[39m\033[38;5;199m/\033[39m\033[38;5;199m_\033[39m\033[38;5;199m/\033[39m\033[38;5;199m \033[39m\033[38;5;163m \033[39m\033[38;5;164m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m/\033[39m\033[38;5;164m \033[39m\033[38;5;164m/\033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m\033[39m")
	fmt.Println("\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;154m \033[39m\033[38;5;148m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m|\033[39m\033[38;5;184m_\033[39m\033[38;5;184m_\033[39m\033[38;5;184m/\033[39m\033[38;5;178m|\033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m/\033[39m\033[38;5;214m\\\033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m_\033[39m\033[38;5;214m/\033[39m\033[38;5;214m_\033[39m\033[38;5;208m.\033[39m\033[38;5;208m_\033[39m\033[38;5;208m_\033[39m\033[38;5;208m_\033[39m\033[38;5;208m/\033[39m\033[38;5;208m_\033[39m\033[38;5;208m/\033[39m\033[38;5;208m \033[39m\033[38;5;208m/\033[39m\033[38;5;208m_\033[39m\033[38;5;209m/\033[39m\033[38;5;203m \033[39m\033[38;5;203m/\033[39m\033[38;5;203m_\033[39m\033[38;5;203m/\033[39m\033[38;5;203m\\\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m_\033[39m\033[38;5;203m/\033[39m\033[38;5;203m_\033[39m\033[38;5;203m/\033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m\\\033[39m\033[38;5;198m_\033[39m\033[38;5;198m_\033[39m\033[38;5;198m,\033[39m\033[38;5;198m_\033[39m\033[38;5;198m/\033[39m\033[38;5;199m \033[39m\033[38;5;199m/\033[39m\033[38;5;199m_\033[39m\033[38;5;199m_\033[39m\033[38;5;199m_\033[39m\033[38;5;199m/\033[39m\033[38;5;199m_\033[39m\033[38;5;199m_\033[39m\033[38;5;199m_\033[39m\033[38;5;163m/\033[39m\033[38;5;164m\\\033[39m\033[38;5;164m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m_\033[39m\033[38;5;164m/\033[39m\033[38;5;164m_\033[39m\033[38;5;164m/\033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;128m \033[39m\033[38;5;129m\033[39m")
	fmt.Println("\033[38;5;148m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;184m \033[39m\033[38;5;178m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;214m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;208m \033[39m\033[38;5;209m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;203m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;198m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;199m \033[39m\033[38;5;163m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;164m \033[39m\033[38;5;128m \033[39m\033[38;5;129m \033[39m\033[38;5;129m \033[39m\033[38;5;129m \033[39m\033[38;5;129m\033[39m")
}
